#!/bin/bash

# Define the configuration file
CONFIG_FILE="$FREETZ_SSL_HOME_PATH/.config"
TEMP_FILE="$FREETZ_SSL_HOME_PATH/tempdatei"

# List of configurations to disable
CONFIGS_TO_DISABLE=(
	"FREETZ_PACKAGE_ACME"
	"FREETZ_PACKAGE_CA_BUNDLE"
	"FREETZ_PACKAGE_OPENSSL"
	"FREETZ_PACKAGE_WGET"
	"FREETZ_BUSYBOX___V127_DESKTOP"
	"FREETZ_BUSYBOX___V136_DESKTOP"
)

# List of configurations to remove completely
CONFIGS_TO_REMOVE=(
	"FREETZ_PACKAGE_OPENSSL_TRACE"
	"FREETZ_PACKAGE_OPENSSL_STATIC"
	"FREETZ_PACKAGE_ACME_deploy"
	"FREETZ_PACKAGE_ACME_dnsapi"
	"FREETZ_PACKAGE_ACME_notify"
	"FREETZ_PACKAGE_ACME_SOCAT"
	"FREETZ_PACKAGE_WGET_WITH_SSL"
	"FREETZ_PACKAGE_WGET_OPENSSL"
	"FREETZ_PACKAGE_WGET_GNUTLS"
	"FREETZ_PACKAGE_WGET_CA_BUNDLE"
	"FREETZ_PACKAGE_WGET_STATIC"
	"FREETZ_BUSYBOX_DESKTOP"
	"FREETZ_BUSYBOX___V127_FEATURE_UNZIP_BZIP2"
	"FREETZ_BUSYBOX___V127_FEATURE_UNZIP_LZMA"
	"FREETZ_BUSYBOX___V127_FEATURE_UNZIP_XZ"
	"FREETZ_BUSYBOX___V127_FEATURE_PS_TIME"
	"FREETZ_BUSYBOX___V127_FEATURE_PS_ADDITIONAL_COLUMNS"
	"FREETZ_BUSYBOX___V136_FEATURE_UNZIP_BZIP2"
	"FREETZ_BUSYBOX___V136_FEATURE_UNZIP_LZMA"
	"FREETZ_BUSYBOX___V136_FEATURE_UNZIP_XZ"
	"FREETZ_BUSYBOX___V136_FEATURE_PS_TIME"
	"FREETZ_BUSYBOX___V136_FEATURE_PS_ADDITIONAL_COLUMNS"
)

# Disable specified configurations
for CONFIG in "${CONFIGS_TO_DISABLE[@]}"; do
	sed -i "s+${CONFIG}=y+# ${CONFIG} is not set+g" "$CONFIG_FILE"
done

# Remove specified configurations
for CONFIG in "${CONFIGS_TO_REMOVE[@]}"; do
	grep -v "$CONFIG" "$CONFIG_FILE" > "$TEMP_FILE" && mv "$TEMP_FILE" "$CONFIG_FILE"
done
